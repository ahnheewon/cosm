<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout}">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
<link rel="stylesheet"
	href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
<link rel="stylesheet"
	href="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.css" />

<script
	src="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.js"></script>
<script src="https://uicdn.toast.com/tui-grid/latest/tui-grid.js"></script>

<!--toast date-picker-->
<link rel="stylesheet"
	href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css" />
<script src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.js"></script>
</head>
<body>
	<div layout:fragment="content">
		<hr style="width: 100%">
		<h3 style="text-align: center">완제품 리스트</h3>
		<br>
		<div id="select_input" >
					<span>입고일자</span>
						<div class="tui-datepicker-input tui-datetime-input tui-has-focus" style="z-index: 1100">
							<input id="startpicker-input" type="text" aria-label="Date" style="z-index: 1100">
							<span class="tui-ico-date"></span>
							<div id="startpicker-container" style="margin-left: -1px; z-index: 1100" ></div>
						</div>
						<span>~</span>
						<div class="tui-datepicker-input tui-datetime-input tui-has-focus" style="z-index: 1100">
							<input id="endpicker-input" type="text" aria-label="Date" style="z-index: 1100">
							<span class="tui-ico-date"></span>
							<div id="endpicker-container" style="margin-left: -1px; z-index: 1100"></div>
						</div>
						<button type="button" class="btn btn-secondary" id="finBtn">조회</button>
					</div>
			
		<input onkeyup="filter2()" type="text" style="float: right" id="searchFilter2">	
		<label style="float: right; margin-right: 20px">검수여부 검색</label>
		<div id="grid"></div>


		<script>
	
	
	
		
	function filter2(){ // 토스트그리드 필터이용 검색함수

		const search = document.getElementById("searchFilter2") //인풋태그
		      
		const state = [{code: 'eq', value: search.value}];
		
		      if(search.value == ''){   
		         
		    	  grid.unfilter('INSPECTION');
		      
		      }else {
		          
		    	  grid.filter(('INSPECTION'), state);
		      }
		      
		}
	
	window.onload = function () {
		//완제품리스트 가져오기
		registList();
	
	}
	var grid = new tui.Grid({
		el: document.getElementById('grid'),
		minBodyHeight: 30,
		pageOptions: {
			useClient: true, // front에서만 페이징 하는 속성
			perPage: 10
		},
		scrollX: false,
		scrollY: false,
		columns: [
			{
				header: 'LOT넘버',
				name: 'REGIST_LOT',
				filter: {
				       type: 'select',
				        showApplyBtn: true,
				        showClearBtn: true
				      },
				align : 'center'
			},
			{
				header: '제품번호',
				name: 'REGIST_PRODUCT_NO',
				align : 'center'
			},	
			{
				header: '바코드 라벨',
				name: 'REGIST_LABEL',
				align : 'center'
			},
			{
				header: '등록수량',
				name: 'REGIST_QUANTITY',
				align : 'center'
			},
			{
				header: '불량수량',
				name: 'REGIST_ERROR',
				align : 'center'
			},	
			{
				header: '등록일자(desc)',
				name: 'REGIST_DATE',
				sortingType: 'desc',
				sortable: true,
				align : 'center',
				filter : 'date'
			},
			{
				header: '지시번호',
				name: 'REGIST_INSTRUCT_NO',
				align : 'center'
			},	
			
			{
				header: '단위코드',
				name: 'CODE_NO',
				align : 'center'
			},	
			{
				header: '검수여부',
				name: 'inspection',
				align : 'center',
				filter : 'text'
			},	
			],
		
		});
	let today = new Date();
	let picker = tui.DatePicker.createRangePicker({
		startpicker : {
			date : today,
			input : '#startpicker-input',
			container : '#startpicker-container',
			
		},
		endpicker : {
			date : today,
			input : '#endpicker-input',
			container : '#endpicker-container',
			
		},
		
		
	})
	
	//완제품리스트 가져오기
	function registList(){
		$('#finBtn').on('click', function(){
			let getStartDay = $('#startpicker-input').val();
			let getEndDay = $('#endpicker-input').val();{}
			
		$.ajax({
			url: "/getDateList",
			data : {
				"startDate" : getStartDay,
				"endDate" : getEndDay
			},
			contentType : "application/json",
			method: "GET",
			dataType: "JSON",
			success: function (result) {
				console.log(result);
				for (let regist of result) {
					regist.REGIST_DATE = String(regist.REGIST_DATE).substr(0, 10);
				}
				grid.resetData(result);

			},
			error: function (reject) {
				console.log(reject);
			}
		});
		})
	}
	
	
	
	
	
	
	</script>
	</div>
</body>
</html>