<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout}">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
<link rel="stylesheet"
	href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
<link rel="stylesheet"
	href="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.css" />

<script
	src="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.js"></script>
<script src="https://uicdn.toast.com/tui-grid/latest/tui-grid.js"></script>

</head>
<body>
	<div layout:fragment="content">
		<hr style="width: 100%">
		<h3 style="text-align: center">완제품 리스트</h3>
		<br>
<!-- 
			<div align="center">
				<div align="right">
					<select id="empSearchType">
						<option value="none">------
					</select> <input type="text" id="empSearchContent" class="searchInput">
					<button id="empFilter">검색</button>
				</div>
				<div id="grid"></div>
			</div> -->
		<input onkeyup="filter()" type="date" style="float: right" id="searchFilter">	
		<label style="float: right; margin-right: 20px">날짜 검색</label>
			
		<input onkeyup="filter2()" type="text" style="float: right" id="searchFilter2">	
		<label style="float: right; margin-right: 20px">검수여부 검색</label>
		<div id="grid"></div>


		<script>
	
	
	function filter(){ // 토스트그리드 필터이용 검색함수

		const search = document.getElementById("searchFilter") //인풋태그
		      
		const state = [{code: 'equals', value: search.value}];
		
		      if(search.value == ''){   
		         
		    	  grid.unfilter('REGIST_DATE');
		      
		      }else {
		          
		    	  grid.filter(('REGIST_DATE'), state);
		      }
		      
		}
	function filter2(){ // 토스트그리드 필터이용 검색함수

		const search = document.getElementById("searchFilter2") //인풋태그
		      
		const state = [{code: 'eq', value: search.value}];
		
		      if(search.value == ''){   
		         
		    	  grid.unfilter('INSPECTION');
		      
		      }else {
		          
		    	  grid.filter(('INSPECTION'), state);
		      }
		      
		}
	
	window.onload = function () {
		//완제품리스트 가져오기
		registList();
	}
	var grid = new tui.Grid({
		el: document.getElementById('grid'),
		minBodyHeight: 30,
		pageOptions: {
			useClient: true, // front에서만 페이징 하는 속성
			perPage: 10
		},
		scrollX: false,
		scrollY: false,
		columns: [
			{
				header: 'LOT넘버',
				name: 'REGIST_LOT',
				filter: {
				       type: 'select',
				        showApplyBtn: true,
				        showClearBtn: true
				      },
				align : 'center'
			},
			{
				header: '제품번호',
				name: 'REGIST_PRODUCT_NO',
				align : 'center'
			},	
			{
				header: '바코드 라벨',
				name: 'REGIST_LABEL',
				align : 'center'
			},
			{
				header: '등록수량',
				name: 'REGIST_QUANTITY',
				align : 'center'
			},
			{
				header: '불량수량',
				name: 'REGIST_ERROR',
				align : 'center'
			},	
			{
				header: '등록일자(desc)',
				name: 'REGIST_DATE',
				sortingType: 'desc',
				sortable: true,
				align : 'center',
				filter : 'date'
			},
			{
				header: '지시번호',
				name: 'REGIST_INSTRUCT_NO',
				align : 'center'
			},	
			
			{
				header: '단위코드',
				name: 'CODE_NO',
				align : 'center'
			},	
			{
				header: '검수여부',
				name: 'INSPECTION',
				align : 'center',
				filter : 'text'
			},	
			],
		
		});
	
	//완제품리스트 가져오기
	function registList(){
		$.ajax({
			url: "/completedList",
			method: "GET",
			dataType: "JSON",
			success: function (result) {
				console.log(result);
				for (let regist of result) {
					regist.REGIST_DATE = String(regist.REGIST_DATE).substr(0, 10);
				}
				grid.resetData(result);
			
				/* for (let i = 1; i < grid.gridEl._component.props.store.column.allColumns.length; i++) {
					let option = $('<option>' + grid.gridEl._component.props.store.column.allColumns[i]
						.header + '</option>').val(grid.gridEl._component.props.store.column.allColumns[i]
						.name);
					$('#empSearchType').append(option)
				}
				
				$('#empSearchType').on('change', function () {
					console.log($('#empSearchType').val());
				})
		
				$('#empFilter').on('click', function () {
					for (let i = 1; i < grid.gridEl._component.props.store.column.allColumns
						.length; i++) {
						grid.unfilter(grid.gridEl._component.props.store.column.allColumns[i].name);
					}
					if ($('#empSearchContent').val() != '') {
						grid.filter($('#empSearchType').val(), [{
							code: 'contain',
							value: $('#empSearchContent').val()
						}]);
					}
				}) */
			
			
			
			},
			error: function (reject) {
				console.log(reject);
			}
		});
	}
	</script>
	</div>
</body>
</html>